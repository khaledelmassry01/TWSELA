<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">`n    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">`n    <meta http-equiv="Pragma" content="no-cache">`n    <meta http-equiv="Expires" content="0">
    <title>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ù†Ø§Ø·Ù‚ - Twsela</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="/src/css/styles.css" rel="stylesheet">
    <link href="/src/css/main.css" rel="stylesheet">
    <link href="/src/css/twsela-design.css" rel="stylesheet">
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <nav class="sidebar">
            <div class="sidebar-header">
                <a href="#" class="sidebar-logo">
                    <i class="fas fa-paper-plane"></i>
                    <span>Twsela</span>
                </a>
            </div>
            <div class="sidebar-nav">
                <a href="/owner/dashboard" class="nav-link">
                    <i class="fas fa-tachometer-alt"></i>
                    <span>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</span>
                </a>
                <a href="/owner/shipments" class="nav-link">
                    <i class="fas fa-shipping-fast"></i>
                    <span>Ø§Ù„Ø´Ø­Ù†Ø§Øª</span>
                </a>
                <a href="/owner/employees" class="nav-link">
                    <i class="fas fa-users"></i>
                    <span>Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†</span>
                </a>
                <a href="/owner/merchants.html" class="nav-link">
                    <i class="fas fa-store"></i>
                    <span>Ø§Ù„ØªØ¬Ø§Ø±</span>
                </a>
                <a href="/owner/zones" class="nav-link active">
                    <i class="fas fa-map-marker-alt"></i>
                    <span>Ø§Ù„Ù…Ù†Ø§Ø·Ù‚</span>
                </a>
                <a href="/owner/pricing" class="nav-link">
                    <i class="fas fa-tags"></i>
                    <span>Ø§Ù„Ø£Ø³Ø¹Ø§Ø±</span>
                </a>
                <a href="/owner/reports" class="nav-link">
                    <i class="fas fa-chart-bar"></i>
                    <span>Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±</span>
                </a>
            </div>
        </nav>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Header -->
            <header class="main-header">
                <div class="header-left">
                    <h1 class="header-title">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ù†Ø§Ø·Ù‚</h1>
                </div>
                <div class="header-actions">
                    <div class="search-container">
                        <input type="text" class="search-input" placeholder="Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ù…Ù†Ø§Ø·Ù‚...">
                        <i class="fas fa-search search-icon"></i>
                    </div>
                    <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addZoneModal">
                        <i class="fas fa-plus"></i>
                        Ø¥Ø¶Ø§ÙØ© Ù…Ù†Ø·Ù‚Ø© Ø¬Ø¯ÙŠØ¯Ø©
                    </button>
                </div>
            </header>

            <!-- Dashboard Content -->
            <div class="dashboard-content">
                <!-- Stats Cards -->
                <div class="stats-grid">
                    <div class="stat-card blue" data-card="0">
                        <div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø´Ø­Ù†Ø§Øª</div>
                        <div class="stat-value">12</div>
                        <div class="stat-icon blue">
                            <i class="fas fa-calendar"></i>
                        </div>
                        <div class="mini-chart">
                            <canvas id="totalShipmentsChart" width="60" height="30"></canvas>
                        </div>
                    </div>

                    <div class="stat-card orange" data-card="1">
                        <div class="stat-label">ÙÙŠ Ø§Ù„Ø·Ø±ÙŠÙ‚</div>
                        <div class="stat-value">8</div>
                        <div class="stat-icon orange">
                            <i class="fas fa-truck"></i>
                        </div>
                        <div class="mini-chart">
                            <canvas id="onthewayChart" width="60" height="30"></canvas>
                        </div>
                    </div>

                    <div class="stat-card green" data-card="2">
                        <div class="stat-label">ØªÙ… Ø§Ù„ØªØ³Ù„ÙŠÙ…</div>
                        <div class="stat-value">6</div>
                        <div class="stat-icon green">
                            <i class="fas fa-check-circle"></i>
                        </div>
                        <div class="card-actions">
                            <button class="btn btn-outline-primary btn-sm">Ø¹Ø±Ø¶ Ø§Ù„ØªÙØ§ØµÙŠÙ„</button>
                            <button class="btn btn-primary btn-sm">ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø­Ø§Ù„Ø©</button>
                        </div>
                    </div>
                </div>

                <!-- Map Visualization -->
                <div class="card">
                    <div class="card-header">
                        <h5 class="card-title">Ø®Ø±ÙŠØ·Ø© Ø§Ù„Ù…Ù†Ø§Ø·Ù‚</h5>
                        <div class="card-actions">
                            <button class="btn btn-outline-primary btn-sm">
                                <i class="fas fa-search"></i>
                                Ø¨Ø­Ø«
                            </button>
                            <button class="btn btn-outline-primary btn-sm">
                                <i class="fas fa-filter"></i>
                                ÙÙ„ØªØ±
                            </button>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="map-container">
                            <div class="map-placeholder">
                                <i class="fas fa-map"></i>
                                <p>Ø®Ø±ÙŠØ·Ø© Ø§Ù„Ù…Ù†Ø§Ø·Ù‚ Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠØ©</p>
                                <div class="map-legend">
                                    <div class="legend-item">
                                        <div class="legend-color blue"></div>
                                        <span>Ù†Ø´Ø·</span>
                                    </div>
                                    <div class="legend-item">
                                        <div class="legend-color orange"></div>
                                        <span>Ù…Ø¹Ù„Ù‚</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Zones Management Table -->
                <div class="card">
                    <div class="card-header">
                        <h5 class="card-title">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ù†Ø§Ø·Ù‚</h5>
                        <div class="card-actions">
                            <button class="btn btn-outline-primary btn-sm">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="btn btn-outline-primary btn-sm">
                                <i class="fas fa-eye"></i>
                            </button>
                            <button class="btn btn-outline-primary btn-sm">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table data-table" id="zonesTable">
                                <thead>
                                    <tr>
                                        <th>Ø§Ø³Ù… Ø§Ù„Ù…Ù†Ø·Ù‚Ø©</th>
                                        <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
                                        <th>Ø±Ø³ÙˆÙ… Ø§Ù„ØªØ³Ù„ÙŠÙ… (Ø¬Ù†ÙŠÙ‡)</th>
                                        <th>Ø§Ù„Ø³Ø§Ø¦Ù‚ÙŠÙ†</th>
                                        <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>
                                            <div class="d-flex align-items-center">
                                                <div class="zone-icon me-2">
                                                    <i class="fas fa-map-marker-alt"></i>
                                                </div>
                                                <div>
                                                    <div class="fw-bold">1 Ø§Ù„Ù…Ù†Ø·Ù‚Ø© Ø§Ù„ÙˆØ³Ø·Ù‰</div>
                                                    <small class="text-muted">Central Zone</small>
                                                </div>
                                            </div>
                                        </td>
                                        <td>
                                            <span class="status-text active">
                                                <span class="status-dot active"></span>
                                                Ù†Ø´Ø·
                                            </span>
                                        </td>
                                        <td>
                                            <div class="d-flex align-items-center">
                                                <span class="status-text active">
                                                    <span class="status-dot active"></span>
                                                    ØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ«
                                                </span>
                                            </div>
                                        </td>
                                        <td>
                                            <span class="badge bg-secondary">L</span>
                                        </td>
                                        <td>
                                            <div class="action-buttons">
                                                <button class="action-btn edit" data-id="1" title="ØªØ¹Ø¯ÙŠÙ„">
                                                    <i class="fas fa-edit"></i>
                                                </button>
                                                <button class="action-btn delete" data-id="1" title="Ø­Ø°Ù">
                                                    <i class="fas fa-trash"></i>
                                                </button>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <div class="d-flex align-items-center">
                                                <div class="zone-icon me-2">
                                                    <i class="fas fa-map-marker-alt"></i>
                                                </div>
                                                <div>
                                                    <div class="fw-bold">2 Ø§Ù„Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø´Ù…Ø§Ù„ÙŠØ©</div>
                                                    <small class="text-muted">North District</small>
                                                </div>
                                            </div>
                                        </td>
                                        <td>
                                            <span class="status-text active">
                                                <span class="status-dot active"></span>
                                                ØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ«
                                            </span>
                                        </td>
                                        <td>
                                            <span class="badge bg-secondary">L</span>
                                        </td>
                                        <td>
                                            <span class="badge bg-primary">$5</span>
                                        </td>
                                        <td>
                                            <div class="action-buttons">
                                                <button class="action-btn edit" data-id="2" title="ØªØ¹Ø¯ÙŠÙ„">
                                                    <i class="fas fa-edit"></i>
                                                </button>
                                                <button class="action-btn delete" data-id="2" title="Ø­Ø°Ù">
                                                    <i class="fas fa-trash"></i>
                                                </button>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <div class="d-flex align-items-center">
                                                <div class="zone-icon me-2">
                                                    <i class="fas fa-map-marker-alt"></i>
                                                </div>
                                                <div>
                                                    <div class="fw-bold">4 Ø§Ù„Ø¶ÙˆØ§Ø­ÙŠ Ø§Ù„Ø¬Ù†ÙˆØ¨ÙŠØ©</div>
                                                    <small class="text-muted">South Suburbs</small>
                                                </div>
                                            </div>
                                        </td>
                                        <td>
                                            <span class="status-text pending">
                                                <span class="status-dot pending"></span>
                                                Ù…Ø¹Ù„Ù‚
                                            </span>
                                        </td>
                                        <td>
                                            <div class="d-flex align-items-center">
                                                <span class="status-text active">
                                                    <span class="status-dot active"></span>
                                                    ØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ«
                                                </span>
                                            </div>
                                        </td>
                                        <td>
                                            <span class="status-dot pending"></span>
                                        </td>
                                        <td>
                                            <div class="action-buttons">
                                                <button class="action-btn edit" data-id="3" title="ØªØ¹Ø¯ÙŠÙ„">
                                                    <i class="fas fa-edit"></i>
                                                </button>
                                                <button class="action-btn delete" data-id="3" title="Ø­Ø°Ù">
                                                    <i class="fas fa-trash"></i>
                                                </button>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <!-- Pagination -->
                        <div class="d-flex justify-content-between align-items-center mt-3">
                            <div class="pagination-info">
                                <span class="text-muted">Ø¹Ø±Ø¶ 1-3 Ù…Ù† 3 Ù†ØªØ§Ø¦Ø¬</span>
                            </div>
                            <div class="pagination">
                                <button class="page-btn" disabled>
                                    <i class="fas fa-chevron-right"></i>
                                </button>
                                <button class="page-btn active">1</button>
                                <button class="page-btn">
                                    <i class="fas fa-chevron-left"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Add Zone Modal -->
    <div class="modal fade" id="addZoneModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Ø¥Ø¶Ø§ÙØ© Ù…Ù†Ø·Ù‚Ø© Ø¬Ø¯ÙŠØ¯Ø©</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="addZoneForm">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group mb-3">
                                    <label for="zoneName" class="form-label">Ø§Ø³Ù… Ø§Ù„Ù…Ù†Ø·Ù‚Ø©</label>
                                    <input type="text" class="form-control" id="zoneName" name="zoneName" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group mb-3">
                                    <label for="zoneCode" class="form-label">Ø±Ù…Ø² Ø§Ù„Ù…Ù†Ø·Ù‚Ø©</label>
                                    <input type="text" class="form-control" id="zoneCode" name="zoneCode" required>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group mb-3">
                                    <label for="deliveryFee" class="form-label">Ø±Ø³ÙˆÙ… Ø§Ù„ØªØ³Ù„ÙŠÙ… (Ø¬Ù†ÙŠÙ‡)</label>
                                    <input type="number" class="form-control" id="deliveryFee" name="deliveryFee" step="0.01" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group mb-3">
                                    <label for="defaultFee" class="form-label">Ø§Ù„Ø±Ø³ÙˆÙ… Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© Ù„Ù„Ù…Ù†Ø·Ù‚Ø© (Ø¬Ù†ÙŠÙ‡)</label>
                                    <input type="number" class="form-control" id="defaultFee" name="defaultFee" step="0.01" value="50.00" required>
                                    <small class="form-text text-muted">Ø§Ù„Ø±Ø³ÙˆÙ… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø© ÙƒØ£ÙˆÙ„ÙˆÙŠØ© Ø«Ø§Ù†ÙŠØ© ÙÙŠ Ø§Ù„ØªØ³Ø¹ÙŠØ±</small>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group mb-3">
                                    <label for="status" class="form-label">Ø§Ù„Ø­Ø§Ù„Ø©</label>
                                    <select class="form-control" id="status" name="status" required>
                                        <option value="ACTIVE">Ù†Ø´Ø·</option>
                                        <option value="INACTIVE">ØºÙŠØ± Ù†Ø´Ø·</option>
                                        <option value="PENDING">Ù…Ø¹Ù„Ù‚</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group mb-3">
                                    <label for="latitude" class="form-label">Ø®Ø· Ø§Ù„Ø¹Ø±Ø¶</label>
                                    <input type="number" class="form-control" id="latitude" name="latitude" step="any">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group mb-3">
                                    <label for="longitude" class="form-label">Ø®Ø· Ø§Ù„Ø·ÙˆÙ„</label>
                                    <input type="number" class="form-control" id="longitude" name="longitude" step="any">
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Ø¥Ù„ØºØ§Ø¡</button>
                    <button type="button" class="btn btn-primary" id="addZoneBtn">Ø¥Ø¶Ø§ÙØ© Ù…Ù†Ø·Ù‚Ø©</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Edit Zone Modal -->
    <div class="modal fade" id="editZoneModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ù†Ø·Ù‚Ø©</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="editZoneForm">
                        <input type="hidden" id="editZoneId" name="zoneId">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group mb-3">
                                    <label for="editZoneName" class="form-label">Ø§Ø³Ù… Ø§Ù„Ù…Ù†Ø·Ù‚Ø©</label>
                                    <input type="text" class="form-control" id="editZoneName" name="zoneName" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group mb-3">
                                    <label for="editZoneCode" class="form-label">Ø±Ù…Ø² Ø§Ù„Ù…Ù†Ø·Ù‚Ø©</label>
                                    <input type="text" class="form-control" id="editZoneCode" name="zoneCode" required>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group mb-3">
                                    <label for="editDeliveryFee" class="form-label">Ø±Ø³ÙˆÙ… Ø§Ù„ØªØ³Ù„ÙŠÙ… (Ø¬Ù†ÙŠÙ‡)</label>
                                    <input type="number" class="form-control" id="editDeliveryFee" name="deliveryFee" step="0.01" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group mb-3">
                                    <label for="editStatus" class="form-label">Ø§Ù„Ø­Ø§Ù„Ø©</label>
                                    <select class="form-control" id="editStatus" name="status" required>
                                        <option value="ACTIVE">Ù†Ø´Ø·</option>
                                        <option value="INACTIVE">ØºÙŠØ± Ù†Ø´Ø·</option>
                                        <option value="PENDING">Ù…Ø¹Ù„Ù‚</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-12">
                                <div class="form-group mb-3">
                                    <label for="editDescription" class="form-label">Ø§Ù„ÙˆØµÙ</label>
                                    <textarea class="form-control" id="editDescription" name="description" rows="3"></textarea>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group mb-3">
                                    <label for="editLatitude" class="form-label">Ø®Ø· Ø§Ù„Ø¹Ø±Ø¶</label>
                                    <input type="number" class="form-control" id="editLatitude" name="latitude" step="any">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group mb-3">
                                    <label for="editLongitude" class="form-label">Ø®Ø· Ø§Ù„Ø·ÙˆÙ„</label>
                                    <input type="number" class="form-control" id="editLongitude" name="longitude" step="any">
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Ø¥Ù„ØºØ§Ø¡</button>
                    <button type="button" class="btn btn-primary" id="updateZoneBtn">Ø­ÙØ¸ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Load shared utilities first -->
    <script src="/src/js/shared/config.js"></script>
    <script src="/src/js/shared/SharedDataUtils.js?v=20250112-13"></script>
    <script src="/src/js/shared/GlobalUIHandler.js?v=20250112-13"></script>
    <script src="/src/js/shared/NotificationService.js?v=20250112-13"></script>
    
    <!-- Load services -->
    <script src="/src/js/services/auth_service.js?v=20250112-13"></script>
    <script src="/src/js/services/api_service.js?v=20250112-13"></script>
    
    <!-- Load app.js first to initialize authentication system -->
    <script src="/src/js/app.js?v=20250112-13"></script>
    
    <!-- Load page handler after app.js is ready -->
    <script>
        // Wait for app.js to be ready before loading page handler
        document.addEventListener('DOMContentLoaded', function() {
            // Small delay to ensure app.js is initialized
            setTimeout(() => {
                const script = document.createElement('script');
                script.src = '/src/js/pages/owner-zones-page.js?v=20250112-14';
                script.onload = function() {
                    console.log('âœ… Owner zones page script loaded');
                };
                script.onerror = function() {
                    console.error('âŒ Failed to load owner zones page script');
                };
                document.head.appendChild(script);
            }, 200); // Wait 200ms for app.js to initialize
        });
    </script>

    <style>
        .zone-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #2563eb;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
        }

        .action-buttons {
            display: flex;
            gap: 5px;
        }

        .map-container {
            height: 400px;
            background: #f8fafc;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .map-placeholder {
            text-align: center;
            color: #6b7280;
        }

        .map-placeholder i {
            font-size: 3rem;
            margin-bottom: 1rem;
        }

        .map-legend {
            position: absolute;
            bottom: 20px;
            right: 20px;
            display: flex;
            gap: 15px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .legend-color {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }

        .legend-color.blue { background: #2563eb; }
        .legend-color.orange { background: #f59e0b; }
    </style>
</body>
</html>
